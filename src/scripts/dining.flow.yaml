# dining.flow.yaml
# é¤é¥®é¢„è®¢æµç¨‹å®šä¹‰ (å‡çº§ç‰ˆ v2.1)
flow:
  name: dining_reservation
  version: "2.1"
  description: "é¤å…é¢„è®¢æ™ºèƒ½è¡¨å•æµç¨‹"
  business_line: dining
  
  process_order:
    - category
    - brand
    - series
    - party_size
    - date
    - budget    # ç¡®ä¿åŒ…å«é¢„ç®—
    - contact
    
  slots:
    category:
      label: "é¢„è®¢ç±»å‹"
      description: "é¢„è®¢ç±»å‹"
      required: true
      allow_llm: false
      type: enum
      enums_key: dining_category
      dependencies: []
      prompt_template: form_category_prompt
      auto_fill: true
      
    brand:
      label: "é¤å…é€‰æ‹©"
      description: "é€‰æ‹©é¤å…"
      required: true
      allow_llm: false
      type: enum
      enums_key: dining_brand
      dependencies: [category]
      prompt_template: form_brand_prompt
      
    series:
      label: "ç”¨é¤æ—¶æ®µ"
      description: "é€‰æ‹©ç”¨é¤æ—¶æ®µ"
      required: true
      allow_llm: false
      type: enum
      enums_key: dining_series
      dependencies: [brand]
      prompt_template: form_series_prompt
      
    party_size:
      label: "ç”¨é¤äººæ•°"
      description: "ç”¨é¤äººæ•°"
      required: true
      allow_llm: false
      type: enum
      enums_key: party_size
      dependencies: [series]
      prompt_template: form_party_size_prompt
      
    date:
      label: "é¢„è®¢æ—¥æœŸ"
      description: "é¢„è®¢æ—¥æœŸ"
      required: true
      allow_llm: true
      type: enum
      enums_key: date
      dependencies: [party_size]
      prompt_template: form_date_prompt
      
    budget:
      label: "äººå‡é¢„ç®—"
      description: "é¢„è®¡æ¶ˆè´¹é¢„ç®—"
      required: false
      allow_llm: true
      type: text
      dependencies: [date]
      prompt_template: form_budget_prompt
        
    contact:
      label: "è”ç³»æ–¹å¼"
      description: "è”ç³»æ–¹å¼"
      required: true
      allow_llm: true
      type: text
      dependencies: [budget]
      prompt_template: form_contact_prompt
  
  events:
    on_start:
      - action: reset_form
      - action: show_template
        template: form_welcome
      - action: show_slot_prompt
        slot: category

    on_all_filled:
      - action: show_summary
      - action: ask_confirm
      
    on_confirm:
      - action: validate_form
      - action: submit_order
      - action: show_template
        template: form_order_confirmed
      - action: show_template
        template: form_order_thanks
      - action: ask_continue
    
    on_restart:
      - action: reset_form
      - action: show_welcome

  commands:
    restart:
      keywords: ["é‡æ–°é¢„è®¢", "é‡æ¥", "reset"]
      action: restart_flow
      
    confirm:
      keywords: ["ç¡®è®¤", "å¥½çš„", "æ˜¯çš„", "æ²¡é—®é¢˜"]
      condition: all_slots_filled
      action: confirm_order
      
    modify:
      keywords: ["ä¿®æ”¹", "æ”¹ä¸€ä¸‹", "é‡é€‰"]
      action: enter_reselect_mode
      
    cancel:
      keywords: ["å–æ¶ˆé¢„è®¢", "ä¸é¢„è®¢äº†"]
      action: cancel_reservation
      
    help:
      keywords: ["å¸®åŠ©", "help"]
      action: show_help
      response: |
        ğŸ“– é¢„è®¢å¸®åŠ©ï¼š
        â€¢ æŒ‰ç…§æç¤ºæä¾›é¢„è®¢ä¿¡æ¯
        â€¢ å¯ä»¥è¯´"ä¿®æ”¹"é‡æ–°é€‰æ‹©æŸé¡¹
        â€¢ è¯´"é‡æ–°é¢„è®¢"å¯ä»¥æ¸…ç©ºé‡æ¥